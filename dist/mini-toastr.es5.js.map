{"version":3,"file":"mini-toastr.es5.js","sources":["../src/common.const.ts","../src/MessageType.ts","../src/MessageClass.ts","../src/mini-toastr-error.class.ts","../src/StyleClass.ts","../src/mini-toastr.ts"],"sourcesContent":["export const LIB_NAME: string = 'mini-toastr'\nexport const DEFAULT_TIMEOUT: number = 3000\nexport const EMPTY_STRING: string = ''","export type MessageType = 'error' | 'warn' | 'success' | 'info'\n\nexport const ERROR: MessageType = 'error'\nexport const WARN: MessageType = 'warn'\nexport const SUCCESS: MessageType = 'success'\nexport const INFO: MessageType = 'info'","import { ERROR, INFO, SUCCESS, WARN } from './MessageType'\n\n// TODO (S.Panfilov) hardcode\nexport declare type MessageClass = '-error' | '-warn' | '-success' | '-info'\n\n// TODO (S.Panfilov) casting\nexport const ERROR_CLASS: MessageClass = `-${ERROR}` as MessageClass\nexport const WARN_CLASS: MessageClass = `-${WARN}`as MessageClass\nexport const SUCCESS_CLASS: MessageClass = `-${SUCCESS}`as MessageClass\nexport const INFO_CLASS: MessageClass = `-${INFO}`as MessageClass","export class MiniToastrError extends Error {\n  constructor (message: string) {\n    super(message)\n    this.message = message\n    this.name = 'MiniToastrError'\n  }\n}\n","import { LIB_NAME } from './common.const'\n\nconst NOTIFICATION = 'notification'\n\n// TODO (S.Panfilov) hardcode\nexport type StyleClass = 'mini-toastr'\n  | 'mini-toastr__notification'\n  | 'mini-toastr-notification__title'\n  | 'mini-toastr-notification__icon'\n  | 'mini-toastr-notification__message'\n\n// TODO (S.Panfilov) casting\nexport const CONTAINER_CLASS: StyleClass = LIB_NAME as StyleClass\nexport const NOTIFICATION_CLASS: StyleClass = `${LIB_NAME}__${NOTIFICATION}` as StyleClass\nexport const TITLE_CLASS: StyleClass = `${LIB_NAME}-${NOTIFICATION}__title` as StyleClass\nexport const ICON_CLASS: StyleClass = `${LIB_NAME}-${NOTIFICATION}__icon` as StyleClass\nexport const MESSAGE_CLASS: StyleClass = `${LIB_NAME}-${NOTIFICATION}__message` as StyleClass","import { Config, FullConfig, Styles } from './Config'\nimport { MiniToastr } from './MiniToastr'\nimport { DEFAULT_TIMEOUT, EMPTY_STRING, LIB_NAME } from './common.const'\nimport { ERROR_CLASS, INFO_CLASS, MessageClass, SUCCESS_CLASS, WARN_CLASS } from './MessageClass'\nimport { ERROR, INFO, MessageType, SUCCESS, WARN } from './MessageType'\nimport { MiniToastrError } from './mini-toastr-error.class'\nimport { CONTAINER_CLASS, ICON_CLASS, MESSAGE_CLASS, NOTIFICATION_CLASS, TITLE_CLASS } from './StyleClass'\n\nfunction fadeOut (element: HTMLElement, cb?: Function): void {\n  let opacity: number = element.style.opacity ? +element.style.opacity : 0.9\n\n  if (opacity > 0.05) {\n    opacity -= 0.05\n  } else if (opacity <= 0.1) {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element)\n      if (cb) cb()\n    }\n  } else {\n    opacity = 0.9\n  }\n\n  element.style.opacity = opacity.toString()\n  // setTimeout(() => fadeOut.apply((<any>this), [element, cb]), 1000 / 30) // TODO (S.Panfilov) wtf is this here?\n}\n\nfunction flatten (obj: any = {}, into: any = {}, prefix: string = EMPTY_STRING): Object { // TODO (S.Panfilov) \"into\" and \"obj\" are any\n  for (const k in obj) {\n    if (obj.hasOwnProperty(k)) {\n      const prop = obj[k]\n      if (prop && typeof prop === 'object' && !(prop instanceof Date || prop instanceof RegExp)) {\n        flatten(prop, into, prefix + k + ' ')\n      } else {\n        if (into[prefix] && typeof into[prefix] === 'object') {\n          into[prefix][k] = prop\n        } else {\n          into[prefix] = {}\n          into[prefix][k] = prop\n        }\n      }\n    }\n  }\n\n  return into\n}\n\nfunction makeCss (styles: Styles): string {\n  const flat = flatten(styles)\n  let str = JSON.stringify(flat, null, 2)\n  str = str.replace(/\"([^\"]*)\": {/g, '$1 {')\n    .replace(/\"([^\"]*)\"/g, '$1')\n    .replace(/(\\w*-?\\w*): ([\\w\\d .#]*),?/g, '$1: $2;')\n    .replace(/},/g, '}\\n')\n    .replace(/ &([.:])/g, '$1')\n\n  str = str.substr(1, str.lastIndexOf('}') - 1)\n\n  return str\n}\n\nfunction isStyleSheet (element: Node | CSSImportRule): element is CSSImportRule {\n  return !!(<any>element).styleSheet\n}\n\nfunction appendStyles (css: string): void {\n  const head = document.head || document.getElementsByTagName('head')[0]\n  const styleElem = makeNode('style') as HTMLStyleElement // TODO (S.Panfilov) casting to HTMLStyleElement\n  styleElem.id = `${LIB_NAME}-styles`\n  styleElem.type = 'text/css'\n\n  if (isStyleSheet(styleElem)) {\n    styleElem.styleSheet.cssText = css // TODO (S.Panfilov) deprecated\n  } else {\n    styleElem.appendChild(document.createTextNode(css))\n  }\n\n  head.appendChild(styleElem)\n}\n\nconst config: FullConfig = {\n  types: { ERROR, WARN, SUCCESS, INFO },\n  animation: fadeOut,\n  timeout: DEFAULT_TIMEOUT,\n  icons: {},\n  appendTarget: document.body,\n  node: makeNode(),\n  allowHtml: false,\n  style: {\n    [`.${CONTAINER_CLASS}`]: {\n      position: 'fixed',\n      'z-index': 99999,\n      right: '12px',\n      top: '12px'\n    },\n    [`.${NOTIFICATION_CLASS}`]: {\n      cursor: 'pointer',\n      padding: '12px 18px',\n      margin: '0 0 6px 0',\n      'background-color': '#000',\n      opacity: 0.8,\n      color: '#fff',\n      'border-radius': '3px',\n      'box-shadow': '#3c3b3b 0 0 12px',\n      width: '300px',\n      [`&.${ ERROR_CLASS}`]: {\n        'background-color': '#D5122B'\n      },\n      [`&.${ WARN_CLASS}`]: {\n        'background-color': '#F5AA1E'\n      },\n      [`&.${ SUCCESS_CLASS}`]: {\n        'background-color': '#7AC13E'\n      },\n      [`&.${ INFO_CLASS}`]: {\n        'background-color': '#4196E1'\n      },\n      '&:hover': {\n        opacity: 1,\n        'box-shadow': '#000 0 0 12px'\n      }\n    },\n    [`.${TITLE_CLASS}`]: {\n      'font-weight': '500'\n    },\n    [`.${MESSAGE_CLASS}`]: {\n      display: 'inline-block',\n      'vertical-align': 'middle',\n      width: '240px',\n      padding: '0 12px'\n    }\n  }\n}\n\nfunction makeNode (type: string = 'div'): HTMLElement {\n  return document.createElement(type)\n}\n\nfunction createIcon (node: HTMLElement, type: MessageType, config: FullConfig): void {\n  const iconNode = makeNode(config.icons[type].nodeType)\n  const attrs = config.icons[type].attrs\n\n  for (const k in attrs) {\n    if (attrs.hasOwnProperty(k)) {\n      iconNode.setAttribute(k, attrs[k])\n    }\n  }\n\n  node.appendChild(iconNode)\n}\n\nfunction addElem (node: HTMLElement, text: string, className: string, config: FullConfig): void {\n  const elem = makeNode()\n  elem.className = className\n  if (config.allowHtml) {\n    elem.innerHTML = text\n  } else {\n    elem.appendChild(document.createTextNode(text))\n  }\n  node.appendChild(elem)\n}\n\nfunction getTypeClass (type: MessageType): MessageClass {\n  if (type === SUCCESS) return SUCCESS_CLASS\n  if (type === WARN) return WARN_CLASS\n  if (type === ERROR) return ERROR_CLASS\n  if (type === INFO) return INFO_CLASS\n\n  throw new MiniToastrError('Unknown class type. Check mini-toastr\\'s config\\s style section\"')\n}\n\nconst miniToastr: MiniToastr = {\n  config,\n  isInitialised: false,\n  showMessage (message: string, title: string, type: MessageType, timeout: number, cb: Function, overrideConf: Config): MiniToastr {\n    const config = { ...this.config, ...overrideConf } as FullConfig // TODO (S.Panfilov) \"Config\" casting\n\n    const notificationElem = makeNode()\n    notificationElem.className = `${NOTIFICATION_CLASS} ${getTypeClass(type)}`\n    notificationElem.onclick = () => config.animation(notificationElem)\n\n    if (title) addElem(notificationElem, title, TITLE_CLASS, config)\n    if (config.icons[type]) createIcon(notificationElem, type, config)\n    if (message) addElem(notificationElem, message, MESSAGE_CLASS, config)\n\n    config.node.insertBefore(notificationElem, config.node.firstChild)\n    setTimeout(() => config.animation(notificationElem, cb), timeout || config.timeout\n    )\n\n    if (cb) cb()\n    return this\n  },\n  init (aConfig: Config): MiniToastr {\n    this.config = { ...config, ...aConfig } as FullConfig // TODO (S.Panfilov) \"config\" is a kinda global scope and \"Config\" casting\n\n    const cssStr = makeCss(this.config.style)\n    appendStyles(cssStr)\n\n    this.config.node.id = CONTAINER_CLASS\n    this.config.node.className = CONTAINER_CLASS\n    this.config.appendTarget.appendChild(this.config.node)\n\n    // Object.keys(this.config.types).forEach(v => {\n    //     this[this.config.types[v]] = function (message: string, title: string, timeout: number, cb: Function, config: Config) {\n    //       this.showMessage(message, title, this.config.types[v], timeout, cb, config)\n    //       return this\n    //     }.bind(this) // TODO (S.Panfilov) bind?\n    //   }\n    // )\n\n    // TODO (S.Panfilov) check if it's working\n    Object.keys(miniToastr.config.types).forEach(v => {\n        miniToastr[miniToastr.config.types[v]] = function (message: string, title: string, timeout: number, cb: Function, config: Config) {\n          miniToastr.showMessage(message, title, miniToastr.config.types[v], timeout, cb, config)\n          return miniToastr\n        }.bind(this) // TODO (S.Panfilov) bind?\n      }\n    )\n\n    this.isInitialised = true\n\n    return this\n  },\n  setIcon (type: string, nodeType: string = 'i', attrs: any = []): MiniToastr { // TODO (S.Panfilov) attrs is any\n    attrs.class = attrs.class ? attrs.class + ' ' + ICON_CLASS : ICON_CLASS\n\n    this.config.icons[type] = { nodeType, attrs }\n\n    return this\n  }\n}\n\nexport default miniToastr"],"names":["LIB_NAME","DEFAULT_TIMEOUT","EMPTY_STRING","ERROR","WARN","SUCCESS","INFO","ERROR_CLASS","WARN_CLASS","SUCCESS_CLASS","INFO_CLASS","message","_super","_this","name","tslib_1.__extends","Error","NOTIFICATION","CONTAINER_CLASS","NOTIFICATION_CLASS","TITLE_CLASS","ICON_CLASS","MESSAGE_CLASS","element","cb","opacity","style","parentNode","removeChild","toString","obj","into","prefix","k","hasOwnProperty","prop","Date","RegExp","flatten","styles","flat","str","JSON","stringify","replace","substr","lastIndexOf","styleSheet","css","head","document","getElementsByTagName","styleElem","makeNode","id","type","isStyleSheet","cssText","appendChild","createTextNode","config","types","animation","fadeOut","timeout","icons","appendTarget","body","node","allowHtml","_a","position","z-index","right","top","cursor","padding","margin","background-color","color","border-radius","box-shadow","width","_b","font-weight","display","vertical-align","createElement","iconNode","nodeType","attrs","setAttribute","text","className","elem","innerHTML","MiniToastrError","miniToastr","isInitialised","showMessage","title","overrideConf","tslib_1.__assign","this","notificationElem","getTypeClass","onclick","addElem","createIcon","insertBefore","firstChild","setTimeout","init","aConfig","appendStyles","makeCss","Object","keys","forEach","v","bind","setIcon","class"],"mappings":"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"}